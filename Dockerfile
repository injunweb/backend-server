FROM golang:1.22.4

WORKDIR /app

ARG DB_USER
ENV DB_USER=$DB_USER

ARG DB_PASSWORD
ENV DB_PASSWORD=$DB_PASSWORD

ARG DB_HOST
ENV DB_HOST=$DB_HOST

ARG DB_PORT
ENV DB_PORT=$DB_PORT

ARG DB_NAME
ENV DB_NAME=$DB_NAME

ARG JWT_SECRET_KEY
ENV JWT_SECRET_KEY=$JWT_SECRET_KEY

ARG GITHUB_TOKEN
ENV GITHUB_TOKEN=$GITHUB_TOKEN

ARG SMTP_HOST
ENV SMTP_HOST=$SMTP_HOST

ARG SMTP_PORT
ENV SMTP_PORT=$SMTP_PORT

ARG SMTP_USERNAME
ENV SMTP_USERNAME=$SMTP_USERNAME

ARG SMTP_PASSWORD
ENV SMTP_PASSWORD=$SMTP_PASSWORD

COPY . .

RUN go mod download

RUN go build -o main cmd/main.go

CMD ["./main"]
